(function(n){"use strict";var t={options:{addButton:"#addToTable",table:"#datatable-editable",dialog:{wrapper:"#dialog",cancelButton:"#dialogCancel",confirmButton:"#dialogConfirm"}},initialize:function(){this.setVars().build().events()},setVars:function(){return this.$table=n(this.options.table),this.$addButton=n(this.options.addButton),this.dialog={},this.dialog.$wrapper=n(this.options.dialog.wrapper),this.dialog.$cancel=n(this.options.dialog.cancelButton),this.dialog.$confirm=n(this.options.dialog.confirmButton),this},build:function(){return this.datatable=this.$table.DataTable({language:{decimal:"",emptyTable:"No data available in table",info:"Showing _START_ to _END_ of _TOTAL_ entries",infoEmpty:"Showing 0 to 0 of 0 entries",infoFiltered:"(filtered from _MAX_ total entries)",infoPostFix:"",thousands:",",lengthMenu:"Show _MENU_ entries",loadingRecords:"Loading...",processing:"Processing...",search:"Search:",zeroRecords:"No matching records found",paginate:{first:"First",last:"Last",next:"Next",previous:"Previous"}},aoColumns:[null,null,null,{bSortable:!1}]}),window.dt=this.datatable,this},events:function(){var i=this;return this.$table.on("click","a.save-row",function(t){t.preventDefault(),i.rowSave(n(this).closest("tr"))}).on("click","a.cancel-row",function(t){t.preventDefault(),i.rowCancel(n(this).closest("tr"))}).on("click","a.edit-row",function(t){t.preventDefault(),i.rowEdit(n(this).closest("tr"))}).on("click","a.remove-row",function(t){t.preventDefault();var a=n(this).closest("tr");n.magnificPopup.open({items:{src:i.options.dialog.wrapper,type:"inline"},preloader:!1,modal:!0,callbacks:{change:function(){i.dialog.$confirm.on("click",function(t){t.preventDefault(),i.rowRemove(a),n.magnificPopup.close()})},close:function(){i.dialog.$confirm.off("click")}}})}),this.$addButton.on("click",function(t){t.preventDefault(),i.rowAdd()}),this.dialog.$cancel.on("click",function(t){t.preventDefault(),n.magnificPopup.close()}),this},rowAdd:function(){var t,a,i;this.$addButton.attr({disabled:"disabled"}),t=['<a href="#" class="hidden on-editing save-row"><i class="fa fa-save"></i></a>','<a href="#" class="hidden on-editing cancel-row"><i class="fa fa-times"></i></a>','<a href="#" class="on-default edit-row"><i class="fa fa-pencil"></i></a>','<a href="#" class="on-default remove-row"><i class="fa fa-trash-o"></i></a>'].join(" "),a=this.datatable.row.add(["","","",t]),(i=this.datatable.row(a[0]).nodes().to$()).addClass("adding").find("td:last").addClass("actions"),this.rowEdit(i),this.datatable.order([0,"asc"]).draw()},rowCancel:function(t){var a;t.hasClass("adding")?this.rowRemove(t):(a=this.datatable.row(t.get(0)).data(),this.datatable.row(t.get(0)).data(a),t.find("td.actions").get(0)&&this.rowSetActionsDefault(t),this.datatable.draw())},rowEdit:function(i){var e,o=this;e=this.datatable.row(i.get(0)).data(),i.children("td").each(function(t){var a=n(this);a.hasClass("actions")?o.rowSetActionsEditing(i):a.html('<input type="text" class="form-control input-block" value="'+e[t]+'"/>')})},rowSave:function(a){var t,i=this;a.hasClass("adding")&&(this.$addButton.removeAttr("disabled"),a.removeClass("adding")),t=a.find("td").map(function(){var t=n(this);return t.hasClass("actions")?(i.rowSetActionsDefault(a),i.datatable.cell(this).data()):n.trim(t.find("input").val())}),this.datatable.row(a.get(0)).data(t),a.find("td.actions").get(0)&&this.rowSetActionsDefault(a),this.datatable.draw()},rowRemove:function(t){t.hasClass("adding")&&this.$addButton.removeAttr("disabled"),this.datatable.row(t.get(0)).remove().draw()},rowSetActionsEditing:function(t){t.find(".on-editing").removeClass("hidden"),t.find(".on-default").addClass("hidden")},rowSetActionsDefault:function(t){t.find(".on-editing").addClass("hidden"),t.find(".on-default").removeClass("hidden")}};n(function(){t.initialize()})}).apply(this,[jQuery]);